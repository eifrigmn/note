# 过期键删除策略

Redis可以通过expir命令设置一个键的过期时间，每个键的过期时间在Redis内部被保存在过期字典中，Redis对过期的键有以下三种删除策略：

## 定时删除

在设置键的过期时间的同时，会创建一个定时器，让定时器在键的过期时间来临时，立即执行对键的删除操作。

+ 优点

能够保证过期键能尽可能快地被删除，以释放内存。

+ 确定

由于每个键都会创建一个定时器，会印象服务器的相应时间和吞吐量。

## 惰性删除

放任过期时间不管，但是每次从键空间中获取键时，都检查取得的键是否过期，如果过期，则立即删除，否则返回该键。

+ 优点

对CPU是最友好的，程序只会在取出键时，才进行过期检查。

+ 缺点

对内存不友好，如果某个键已经过期，但是一直未被查询，则它会一直占用内存空间。

## 定期删除

每隔一段时间，程序就对数据库进行一次检查，删除里面的过期键。至于要删除多少过期键，以及要检查多少个数据库，则由算法决定。

## Redis的过期键删除策略

由于定期删除策略不一定在单次扫描时清除所有过期键，因此，Redis服务器实际使用的是惰性删除和定期删除两种策略相互配合。