## 架构

大体来说，MySQL可以分为Server层和存储引擎层两部分。存储引擎层负责数据的存储和提取，剩余的功能由Server层提供。

InnoDB、MyISAM、Memory等属于不同的存储引擎，它们都对应同一个Server层。

todo 图

### 连接器

MySQL在执行过程中临时使用的内存是在连接对象中管理的，长期不关闭的连接可能由于临时内存的累积而OOM，可以通过如下两种方式解决：

+ 业务系统中主动断开长连接：
  + 定期
  + 在执行完一个占用内存的大查询后

+ version >=5.7，可以通过执行`mysql_reset_connection`重新初始化连接资源

### 分析器

+ 词法分析

  关键字识别及转换，判断涉及的表及字段是否存在

+ 语法分析

  判断转化后的SQL语句是否符合MySQL语法

### 优化器

选择合适的索引，决定联表顺序等，确定SQL语句的执行方案。

### 执行器

开始执行SQL语句，判断是否有权限拿取数据

